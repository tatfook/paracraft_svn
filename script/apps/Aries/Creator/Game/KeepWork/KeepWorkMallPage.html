<!-- "script/apps/Aries/Creator/Game/Tasks/Friend/KeepWorkMallPage.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>
<pe:mcml>
<script refresh="true" type="text/npl" src="KeepWorkMallPage.lua"><![CDATA[
local KeepWorkMallPage = NPL.load("(gl)script/apps/Aries/Creator/Game/KeepWork/KeepWorkMallPage.lua");
KeepWorkMallPage.OnInit()
function ClosePage()
    Page:CloseWindow();
end
function OnChangeTopBt(index)
    KeepWorkMallPage.OnChangeTopBt(index);
end
function IsSelected(index)
    return KeepWorkMallPage.top_bt_index == index;
end
function TreeItems(index)
    return KeepWorkMallPage.menu_data_sources
end
function GridsItems(index)
    if(index == nil) then    
        return #KeepWorkMallPage.grid_data_sources[KeepWorkMallPage.top_bt_index][KeepWorkMallPage.menu_item_index];
    else
        return KeepWorkMallPage.grid_data_sources[KeepWorkMallPage.top_bt_index][KeepWorkMallPage.menu_item_index][index];
    end
end
function ClickItem(index)
    KeepWorkMallPage.ClickItem(index)
end
function TypeBeExpand(expanded)
    if(expanded and expanded == true) then
        return true;
    else
        return false;
    end
end
function ItemBeSelected(type_index,menu_item_index)
    if(KeepWorkMallPage.menu_item_index == menu_item_index) then
        return true;
    else
        return false;
    end
end
function ChangeMenuType(treenode)
    local attr = treenode.mcmlNode:GetPreValue("this");
    KeepWorkMallPage.ChangeMenuType(attr.level, attr.index)
    
end
function ChangeMenuItem(name,mcmlNode)

    local type_index = tonumber(mcmlNode:GetAttribute("param1"));
    local menu_item_index = tonumber(mcmlNode:GetAttribute("param2"));

    KeepWorkMallPage.ChangeMenuItem(menu_item_index)
end

function SearchBlock(name,mcmlNode)
    local search_ctrl = Page:FindUIControl(name)
    print("ffffffffffffffffffff", search_ctrl.text)
end
function OnclickBuy(name,mcmlNode)
    local exid = tonumber(mcmlNode:GetAttribute("param1"));
    local gsid = 30102
	local command = System.App.Commands.GetCommand("Profile.Aries.PurchaseItemWnd");
	if(command) then
		command:Call({gsid = gsid,callback=callback});
	end
end
]]></script>
<aries:window mode="thin" width="650" height="450" title='<%= L"资源中心"%>' onclose="ClosePage">
<div style="color:#ffffff">

    <div style="margin-left:13px;margin-top:5px;width:210px;">
        <div style="width:210px;height:27px;background:url(Texture/Aries/Creator/Desktop/Inventory_32bits.png#32 364 32 32:8 8 8 8);">
            <input type="text" EmptyText='<%=L"搜索: 请输入您要查找的账号"%>' name="block_search_text_ctl" uiname="block_search_text_obj" CaretColor="#FFFFFFFF" style="margin-top:2px;margin-left:5px;textcolor:#cccccc;height:25px;background:;" onmodify="SearchBlock" />
        </div>
    </div>

    <div>
        <pe:if condition='<%= IsSelected(1)%>'>
            <input type="button" name="1" value='<%=L"全部"%>' onclick="OnChangeTopBt" tooltip='<%=L"全部"%>' style="width:80px;margin-left:2px;margin-top:8px;color:#ffffff;" class="mc_blue_button_with_fillet"/>
        </pe:if>
        <pe:if condition='<%= not IsSelected(1)%>'>
            <input type="button" name="1" value='<%=L"全部"%>' onclick="OnChangeTopBt" tooltip='<%=L"全部"%>' style="width:80px;margin-left:2px;margin-top:8px;" class="mc_light_grey_button_with_fillet"/>
        </pe:if>
        <pe:if condition='<%= IsSelected(2)%>'>
            <input type="button" name="2" value='<%=L"最新"%>' onclick="OnChangeTopBt" tooltip='<%=L"最新"%>' style="width:50px;margin-left:2px;margin-top:8px;color:#ffffff;" class="mc_blue_button_with_fillet"/>
        </pe:if>
        <pe:if condition='<%= not IsSelected(2)%>'>
            <input type="button" name="2" value='<%=L"最新"%>' onclick="OnChangeTopBt" tooltip='<%=L"最新"%>' style="width:50px;margin-left:2px;margin-top:8px;" class="mc_light_grey_button_with_fillet"/>
        </pe:if>
        <pe:if condition='<%= IsSelected(3)%>'>
            <input type="button" name="3" value='<%=L"热门"%>' onclick="OnChangeTopBt" tooltip='<%=L"热门"%>' style="width:50px;margin-left:2px;margin-top:8px;color:#ffffff;" class="mc_blue_button_with_fillet"/>
        </pe:if>
        <pe:if condition='<%= not IsSelected(3)%>'>
            <input type="button" name="3" value='<%=L"热门"%>' onclick="OnChangeTopBt" tooltip='<%=L"热门"%>' style="width:50px;margin-left:2px;margin-top:8px;" class="mc_light_grey_button_with_fillet"/>
        </pe:if>
        
    </div>

    <div style="position:relative;margin-left:2px;margin-top:5px;width:131px;">
        <pe:treeview name="tvwHelp" DataSource='<%=TreeItems()%>' OnClick="ChangeMenuType" ItemToggleSize="0" style="height:400px;background:" VerticalScrollBarOffsetX="6">
            <NodeTemplates>
                <NodeTemplate DataType="type">
                    <pe:treenode RenderTemplate="type_template" MouseOverBG="" expanded='<%=XPath("this|expanded")%>' can_select="true"></pe:treenode>
                </NodeTemplate>
                <NodeTemplate DataType="type_template">
                    <div style="margin-left:0px;margin-top:5px;height:23px;width:123px;" class="mc_button_grey">
                        <pe:if condition='<%= TypeBeExpand(XPath("this|expanded")) == false %>'>
                            <div style="float:left;margin-left:7px;margin-top:5px;width:6px;height:11px;background:url(Texture/Aries/Creator/Theme/GameCommonIcon_32bits.png#476 74 6 11);" />
                        </pe:if>
                        <pe:if condition='<%= TypeBeExpand(XPath("this|expanded")) == true %>'>
                            <div style="float:left;margin-left:4px;margin-top:8px;width:11px;height:6px;background:url(Texture/Aries/Creator/Theme/GameCommonIcon_32bits.png#417 81 11 6);" />
                        </pe:if>
                        <input type="button" value='<%=XPath("this|text") %>' name='<%=XPath("this|index") %>' style="margin-left:5px;width:100px;height:23px;font-weight:bold;color:#ffffff;text-offset-y:-2;text-align:left;background:" />
                    </div>
                </NodeTemplate>
                <NodeTemplate DataType="item">
                    <div style="height:32px;margin-left:2px;" MouseOverBG="">
                        <pe:if condition='<%= ItemBeSelected(XPath("this|type_index"),XPath("this|menu_item_index")) %>'>
                            <input type="button" value='<%=XPath("this|text") %>' name='<%=XPath("this|text") %>' onclick="ChangeMenuItem" param1='<%= XPath("this|type_index") %>' param2='<%= XPath("this|menu_item_index") %>' style="margin-top:5px;width:110px;height:23px;font-weight:bold;color:#ffffff;text-align:left;" class="mc_button_blue" />
                        </pe:if>
                        <pe:if condition='<%= not ItemBeSelected(XPath("this|type_index"),XPath("this|menu_item_index")) %>'>
                            <input type="button" value='<%=XPath("this|text") %>' name='<%=XPath("this|text") %>' onclick="ChangeMenuItem" param1='<%= XPath("this|type_index") %>' param2='<%= XPath("this|menu_item_index") %>' style="margin-top:5px;width:110px;height:23px;font-weight:bold;color:#ffffff;text-align:left;" class="mc_button_grey" />
                        </pe:if>
                    </div>
                </NodeTemplate>
            </NodeTemplates>
        </pe:treeview>
    </div>

    <div>
        <div style="position:relative;margin-left:200px;margin-top:2px;width:400px;height:300px;background-color:#000000;"></div>
        <pe:gridview style="margin-left:200px;" name="item_gridview" CellPadding="2" VerticalScrollBarStep="36" 
                     VerticalScrollBarOffsetX="8" AllowPaging="true" ItemsPerLine="3" DefaultNodeHeight="50"
                     DataSource='<%=GridsItems%>' pagesize="9">
            <PagerSettings Position="Bottom" height="36" style="position:relative;width:340px;margin-top:-30px;height:32px;" PreviousPageText="previous page" NextPageText="next page"/>
            <PagerTemplate>
                <form>
                    <!-- <div style="float:left;margin-top:1px;padding:2px;font-size:12px;color:#022a57;background:url(Texture/Aries/common/themekid/equip_view/panel_joybean_32bits.png:5 5 5 5)">
                        <pe:item gsid="17213" isenabled="false" style="width:20px;height:20px;"/>
                        <div style="float:left;margin-left:2px;">仙豆:</div><div style="float:left;max-width:45px;text-singleline:true"><pe:slot type="count" gsid="17213" style="float:left;" /></div>
                    </div> -->
                    <input type="button" name="pre" zorder="2" style="width:22px;height:22px;margin-left:5px;background:url(Texture/Aries/common/themekid/cards/left_arrow_32bits.png#0 0 21 21);"/>
                    <div style="float:left;margin-top:0px;text-singleline:true">
                        <label name="page" style="color:#FFFFFF;text-align:center;width:45px;height:18px;margin:4px"/>
                    </div>
                    <input type="button" name="next" zorder=2 style="width:22px;height:22px;background:url(Texture/Aries/common/themekid/cards/right_arrow_32bits.png#0 0 21 21)"/>
                    <!-- <input type="button" zorder="2" tooltip='<%=xxxx %>' value='<%="容量:" .. 222 %>' 
                            style="position:relative;margin-left:5px;font-size:12px;margin-top:1px;height:23px;color:#022a57;background:url(Texture/Aries/common/themekid/equip_view/panel_joybean_32bits.png:5 5 5 5)" name="bagSize"  param1='3'/> -->
                </form>
            </PagerTemplate>
            <Columns>
                <!-- <div style="width:100px;height:100px;padding-left:0px;">
                    <div style="position:relative">
                        <input type="button" name='<%= Eval("index")%>' style="width:70px;height:60px;color:#ffffff;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_gray_32bits.png#0 0 70 60);" tooltip='<%="啊啊啊"%>' onclick="" />
                        <div style="position:relative;margin-left:-15px;width:90px;height:60px;color:#7a7a7a;">
                            <div style="text-align:center;">
                                <%= Eval("name")%>
                            </div>
                        </div>
                    </div>
                    <input type="button" name='<%= Eval("name")%>' style="width:70px;height:60px;background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_green_32bits.png#0 0 70 60);" tooltip='<%="啊啊啊"%>' onclick="" />
                    <div style="position:relative;margin-left:-15px;width:90px;height:60px;color:#7a7a7a;">
                        <div style="text-align:center;">
                            <%= Eval("name")%>
                        </div>

                    </div>
                    <div style="position:relative;margin-left:-5px;margin-top:-70px;width:70px;height:70px;background:" >
                        <img style="background:url(Texture/Aries/Creator/keepwork/LearningDailyCheck/play_gray_32bits.png#0 0 70 60);width:70px;height:60px;"/>
                    </div>  
                </div> -->
                    <div style="width:140px;height:93px;background:url(Texture/Aries/HaqiShop/bg.png#0 0 16 16:5 5 5 5);">
                        <div style="margin-left:3px;margin-top:2px;width:158px;height:20px;font-size:12;font-weight:bold;text-align:center;color:#03285A;"><%=Eval("name") %></div>
                        <div >
                            <div style="float:left;margin-left:3px;margin-top:2px;padding:5px;width:64px;height:64px;background:url(Texture/Aries/NewProfile/bg_equip_32bits.png#0 0 32 32:5 5 5 5);">
                                <pe:item zorder="2" onclick="" isdragable="false" gsid='<%=2408%>' showdefaulttooltip="true" style="margin-left:0px;width:54px;height:54px;" />
                                <!-- <pe:if condition='<%=not IsRightSchool(Eval("gsid")) %>'>
                                    <div zorder="1" style="position:relative;margin-left:-4px;margin-top:-59px;width:62px;height:62px;background:url(Texture/Aries/Desktop/ItemOutline/outline_school_not_match_32bits.png: 7 7 7 7)"/>
                                </pe:if> -->
                            </div>
                            <pe:if condition='<%=true %>'>
                                <div style="float:left;margin-left:5px;padding-left:5px;font-size:12px;">
                                    <div style="height:18px;"><%=999 %></div>
                                </div>
                                <div>
                                    <pe:goalpointer listen="purchase" param_name1="gsid" param_value1='<%=Eval("gsid")%>' style="position:relative;margin-left:120px;margin-top:-25px;width:50px;height:26px"></pe:goalpointer>
                                    <input type="button" class="button" value="购买" onclick="OnclickBuy()" name='<%=0 %>' param1='<%=2404 %>' param2='<%=2408 %>' style="margin-left:80px;margin-top:-22px;font-size:12px;width:50px;"/>
                                </div>
                            </pe:if>
                            <!-- <pe:if condition='<%=Eval("exid")~=0 or IncludeSpecialID(Eval("exid"),Eval("gsid"))%>'>
                                <pe:if condition='<%=true %>'>
                                    <div style="float:left;margin-left:0px;padding-left:1px;font-size:12px;">
                                        <div style="height:18px;"><%=GetLine(Eval("exid"),1, true) %></div>
                                        <div style="height:18px;"><%=GetLine(Eval("exid"),2, true) %></div>
                                        <div style="height:18px;"><%=GetLine(Eval("exid"),3, true) %></div>
                                    </div>
                                    <div><input type="button" value="出售" class="button" onclick="DoSell()" name='<%=Eval("exid") %>' param1='<%=Eval("exid") %>' param2='<%=Eval("gsid") %>' style="margin-left:105px;margin-top:-22px;font-size:12px;width:50px;"/></div>
                                </pe:if>
                                <pe:if condition='<%=not IsSelling(Eval("gsid"), Eval("exid")) %>'>
                                    <div style="float:left;margin-left:0px;padding-left:1px;font-size:12px;">
                                        <pe:if condition='<%=Eval("exid")~=0 %>'>
                                            <div style="height:18px;"><%=GetLine(Eval("exid"),1) %></div>
                                            <div style="height:18px;"><%=GetLine(Eval("exid"),2) %></div>
                                            <div style="height:18px;"><%=GetLine(Eval("exid"),3) %></div>
                                        </pe:if>
                                        <pe:if condition='<%=Eval("exid")==0 %>'>
                                            <%=GetSingleItemPrice(Eval("gsid")) %>
                                        </pe:if>
                                    </div>
                                    <div>
                                        <pe:if condition='<%=not IncludeSpecialID(Eval("exid"),Eval("gsid")) %>'>
                                            <pe:goalpointer listen="purchase" param_name1="gsid" param_value1='<%=Eval("gsid")%>' style="position:relative;margin-left:120px;margin-top:-25px;font-size:12px;width:50px;height:26px"></pe:goalpointer>
                                            <input type="button" class="button" value="购买" onclick="DoBuy()" name='<%=Eval("exid") %>' param1='<%=Eval("exid") %>' param2='<%=Eval("gsid") %>' style="margin-left:105px;margin-top:-22px;font-size:12px;width:50px;"/>
                                        </pe:if>
                                        <pe:if condition='<%=IncludeSpecialID(Eval("exid"),Eval("gsid")) %>'>
                                            <input type="button" class="button" value="领取" onclick="DoExchange()" name='<%=Eval("exid") %>' param1='<%=Eval("exid") %>' param2='<%=Eval("gsid") %>' style="margin-left:105px;margin-top:-22px;font-size:12px;width:50px;"/>
                                        </pe:if>
                                    </div>
                                </pe:if>
                            </pe:if> -->
                        </div>
                    </div>
            </Columns>
            <EmptyDataTemplate>
            </EmptyDataTemplate>
        </pe:gridview>
    </div>

    <!--<div type ="box" style="margin-bottom:0px;">
        底部
        <input type="button" name="last" value="添加好友" onclick="" tooltip="添加好友"/>
        <input type="button" name="last" value="好友申请" onclick="" tooltip="好友申请"/>
    </div>-->
</div>

        </aries:window>
    </pe:mcml>
</body>
</html>

