<!-- "script/apps/Aries/Desktop/NotificationTemplate/MultipleItems.html" -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>MultipleItems notification, by Andy, 2010/7/8</title>
</head>
<body>
    <pe:mcml>
<script type="text/npl" ><![CDATA[
local page = document:GetPageCtrl();
local ItemManager = System.Item.ItemManager;
local hasGSItem = ItemManager.IfOwnGSItem;
local equipGSItem = ItemManager.IfEquipGSItem;

itemlist = page:GetRequestParam("itemlist");

local items = {};
local pair;
for pair in string.gmatch(itemlist, "%((.-)%)") do
    local gsid, count = string.match(pair, "^(.+),(.+)$")
    if(gsid and count) then
        local name = "";
        local background = "";
        local gsItem = System.Item.ItemManager.GetGlobalStoreItemInMemory(tonumber(gsid));
        if(gsItem) then
	        name = gsItem.template.name;
	        background = gsItem.icon;
        elseif(tonumber(gsid) == 0) then
            name = "奇豆";
            background = "Texture/Aries/Item/0_JoyBean.png";
        end
        local displayline = name.."x"..count;
        if(tonumber(count) == 1) then
            displayline = name;
        elseif(tonumber(count) and tonumber(count) < 0) then
            displayline = name.." "..count;
        end
        if(tonumber(count) and tonumber(count) > 0) then
            table.insert(items, {
                gsid = tonumber(gsid),
                count = tonumber(count),
                displayline = displayline,
                background = background,
            })
        end
    end
end

count = 1;

local _, obj;
for _, obj in ipairs(items) do
    if(_ == 1) then
        background1 = obj.background;
        notify_word_line1 = obj.displayline;
        count = 1;
    elseif(_ == 2) then
        background2 = obj.background;
        notify_word_line2 = obj.displayline;
        count = 2;
    elseif(_ == 3) then
        background3 = obj.background;
        notify_word_line3 = obj.displayline;
        count = 3;
    elseif(_ == 4) then
        background4 = obj.background;
        notify_word_line4 = obj.displayline;
        count = 4;
    elseif(_ == 5) then
        background5 = obj.background;
        notify_word_line5 = obj.displayline;
        count = 5;
    elseif(_ == 6) then
        background6 = obj.background;
        notify_word_line6 = obj.displayline;
        count = 6;
    end
end

]]></script>
<div style="margin-top:-370px;">
    <pe:if condition='<%=Eval("count") <= 1%>'>
        <div style="width:10px;height:66px;">
            
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") <= 2%>'>
        <div style="width:10px;height:66px;">
            
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") <= 3%>'>
        <div style="width:10px;height:66px;">
            
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") <= 4%>'>
        <div style="width:10px;height:66px;">
            
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") <= 5%>'>
        <div style="width:10px;height:66px;">
            
        </div>
    </pe:if>

<div style="background:url(Texture/Aries/Common/Notification_bg_32bits.png: 30 30 30 30)">
    <div style="height:50px;margin-left:30px;margin-top:25px;margin-right:20px;">
        你获得了:
    </div>
    <br/>
    <pe:if condition='<%=Eval("count") >= 1%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background1")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line1")%>
            </div>
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") >= 2%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background2")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line2")%>
            </div>
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") >= 3%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background3")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line3")%>
            </div>
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") >= 4%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background4")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line4")%>
            </div>
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") >= 5%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background5")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line5")%>
            </div>
        </div>
    </pe:if>
    <pe:if condition='<%=Eval("count") >= 6%>'>
        <div style="height:120px;margin-left:0px;margin-top:-54px;margin-right:30px;">
            <img src='<%=Eval("background6")%>' style="width:48px;height:48px;margin-left:30px;margin-top:35px;"/>
            <div style="float:left;height:50px;margin-left:10px;margin-top:45px;margin-right:0px;">
                <%=Eval("notify_word_line6")%>
            </div>
        </div>
    </pe:if>
    <div style="height:100px;margin-left:0px;margin-top:-54px;margin-right:30px;">
        <img src='' style="width:163px;height:28px;margin-left:30px;margin-top:35px;"/>
    </div>
</div>

</div>
</pe:mcml>
</body>
</html>